<html>
  <head>
  </head>
  <body>
    <a href="../index.html">Back</a>
    <script>
      var enemy = {
          hp: 5,
          rage: 0,
          attack: function () {
              this.rage += 1;
          },
          getBB: function () {}
      };
      enemy.attack();
      console.log(enemy.rage); // Output: 1

      var physicsManager = {},
          player = {
              getBB: function () {}
          };

      physicsManager.collisionsDetected = 0;
      physicsManager.checkCollision = function (entity1, entity2) {
          var bbCollision = function (bb1, bb2) {
              // Collision code omitted
              var collision = true;
              if (collision) {
                  // WARNING: ’this’ is the global object and not ’physicsManager’
                  this.collisionsDetected += 1;
              }
              return collision;
          };
          bbCollision(entity1.getBB(), entity2.getBB());
      };
      if (physicsManager.checkCollision(enemy, player)) {
          player.takeDamage(enemy.strength);
      }

      console.log(physicsManager.collisionsDetected); // Output: 0

      physicsManager.checkCollision = function (entity1, entity2) {
          var that = this;
          var bbCollision = function (bb1, bb2) {
              // Collision code omitted
              var collision = true;
              if (collision) {
                  that.collisionsDetected += 1;
              }
              return collision;
          };
          bbCollision(entity1.getBB(), entity2.getBB());
      };

      if (physicsManager.checkCollision(enemy, player)) {
          player.takeDamage(enemy.strength);
      }

      console.log(physicsManager.collisionsDetected); // Output: 1

      var Player = function (name) {
          this.name = name;
          this.lives = 3;
      };

      Player.prototype.sayMyName = function () {
          console.log('My name is ' + this.name);
      };

      var david = new Player('David');
      david.sayMyName(); // Output: ’My name is David’

      var manfred = Player('Manfred'); // oops
      try {
          manfred.sayMyName(); // raise an error because david is undefined
      } catch(e) {
          console.log('[' + e.name + '] ' + e.message);
      }
      // Global variables feast
      console.log(name); // Output: ’Manfred’
      console.log(lives); // Output: 3

      var anotherEnemy = {
          rage: 10
      };
      enemy.attack.apply(anotherEnemy, []);
      console.log(anotherEnemy.rage); // Output: 11

      function doActions() {
          var i, l;
          // WARNING: arguments is an Array-like object
          for (i = 0, l = arguments.length; i < l; i += 1) {
              console.log('Doing action ' + arguments[i]);
          }
      }
      doActions('jump', 'attack');

      var Enemy = function () {};
      Enemy.prototype.hit = function (player) { 
          console.log("Hit player " + player.name) 
      };

      player.name = "David";

      function isGameOver() {
          var enemy = new Enemy();
          function checkHit() {
              return enemy.hit(player);
          }
          return checkHit();
      }
      isGameOver();

      var physicsModule = (function () { // IIEF pattern
          var detectedCollisions = 0;
          function checkBBCollision(bb1, bb2) {
              // collision code omitted
              var collision = true;
              if (collision) {
                detectedCollisions += 1;
              }
              return collision;
          }
          function checkCollision(entity1, entity2) {
              checkBBCollision(entity1.getBB(), entity2.getBB());
          }
          return {
              checkCollision: checkCollision
          };
      }());

      console.log(physicsModule.detectedCollisions); // Output: undefined
      console.log(physicsModule.checkBBCollision); // Output: undefined
      console.log(typeof physicsModule.checkCollision); // Output: 'function'
    </script>
  </body>
</html>
